{% load static i18n %} <!-- Load i18n for internationalization -->
<!DOCTYPE html>
<html lang="{% get_current_language as LANGUAGE_CODE %}{{ LANGUAGE_CODE }}" dir="{% if LANGUAGE_CODE == 'ar' %}rtl{% else %}ltr{% endif %}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- SEO Meta Tags -->
  <title>{% block title %}{% trans "StudySmart | AI & Data Solutions" %}{% endblock %}</title>
  <meta name="description" content="{% trans 'StudySmart provides AI, data analytics, and innovative solutions for businesses in the USA, China, UAE, and globally.' %}">
  <meta name="keywords" content="{% trans 'AI, data analytics, StudySmart, USA, China, UAE, Europe, Asia, machine learning, business solutions' %}">
  <meta name="robots" content="index, follow">
  <meta name="author" content="{% trans 'StudySmart Team' %}">

  <!-- Open Graph for Social Sharing -->
  <meta property="og:title" content="{% trans 'StudySmart | AI & Data Solutions' %}">
  <meta property="og:description" content="{% trans 'Transforming businesses with AI and data analytics in the USA, China, UAE, and beyond.' %}">
  <meta property="og:image" content="{% static 'images/sTUdysmart.png' %}">
  <meta property="og:url" content="https://www.studysmartexperts.com{% url 'index' %}">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="StudySmart">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@wenslause5">
  <meta name="twitter:title" content="{% trans 'StudySmart | AI & Data Solutions' %}">
  <meta name="twitter:description" content="{% trans 'AI and data solutions for global businesses.' %}">
  <meta name="twitter:image" content="{% static 'images/sTUdysmart.png'[@]}">

  <!-- Hreflang for Internationalization -->
  <link rel="alternate" hreflang="en" href="https://www.studysmartexperts.com{% url 'index' %}?lang=en">
  <link rel="alternate" hreflang="zh-cn" href="https://www.studysmartexperts.com{% url 'index' %}?lang=zh-cn">
  <link rel="alternate" hreflang="ar" href="https://www.studysmartexperts.com{% url 'index' %}?lang=ar">
  <link rel="alternate" hreflang="x-default" href="https://www.studysmartexperts.com{% url 'index' %}">

  <!-- Canonical URL -->
  <link rel="canonical" href="https://www.studysmartexperts.com{% url 'index' %}">

  <!-- Google Web Fonts (Async via Web Font Loader) -->
  <script defer>
    (function(d) {
      var wf = d.createElement('script'), s = d.scripts[0];
      wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
      wf.async = true;
      s.parentNode.insertBefore(wf, s);
    })(document);
    WebFontConfig = {
      google: { families: ['Orbitron:400,700', 'Roboto:300,400,700'] }
    };
  </script>

  <!-- Icon Font Stylesheet -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" media="print" onload="this.media='all'">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" media="print" onload="this.media='all'">

  <!-- Favicon -->
  <link rel="icon" href="{% static 'images/sTUdysmart.png' %}" type="image/png" sizes="16x16">

  <!-- Bootstrap CSS (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous" media="print" onload="this.media='all'">

  <!-- Template Stylesheets -->
  <link href="{% static 'css/styles.css' %}" rel="stylesheet">
  <link href="{% static 'css/admin.css' %}" rel="stylesheet">

  <!-- Google Analytics (GA4) -->
  <script defer async src="https://www.googletagmanager.com/gtag/js?id=G-D361H1K7LY"></script>
  <script defer>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-D361H1K7LY', {
      'anonymize_ip': true, // GDPR compliance for Europe
      'page_path': window.location.pathname
    });
  </script>

  <!-- Baidu Tongji for China (Conditional) -->
  {% if LANGUAGE_CODE == 'zh-cn' %}
  <script defer>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?YOUR_BAIDU_TONGJI_ID";
      hm.async = true;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
  {% endif %}

  <!-- Preload Critical Assets -->
  <link rel="preload" href="{% static 'images/sTUdysmart.png' %}" as="image">
  <link rel="preload" href="{% static 'css/styles.css' %}" as="style">
</head>
<body>
  <!-- GDPR Cookie Consent (Europe) -->
  <div id="cookie-consent" class="d-none" role="alert">
    <div class="container">
      <p>{% trans "We use cookies to enhance your experience. By continuing, you agree to our" %} <a href="/privacy-policy/">{% trans "Privacy Policy" %}</a>.</p>
      <button id="accept-cookies" class="btn btn-wens">{% trans "Accept" %}</button>
      <button id="decline-cookies" class="btn btn-secondary">{% trans "Decline" %}</button>
    </div>
  </div>

  <!-- Spider-Web Background -->
  <canvas id="spider-web-bg"></canvas>

  <!-- Matrix Overlay -->
  <div id="matrix-overlay"></div>
  <button id="skip-matrix" class="btn btn-wens">
    {% trans "Skip Demo" %} <i class="fas fa-forward"></i>
  </button>

  <!-- base.html (Navbar Section) -->
<nav class="navbar navbar-expand-lg navbar-dark">
  <div class="container">
    <a class="navbar-brand" href="{% url 'index' %}"><h2><i class="fas fa-robot me-2" style="color: var(--wens-blue);"></i>{% trans "StudySmart" %}</h2></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="{% trans 'Toggle navigation' %}">
      <span class="custom-toggler-icon">
        <span class="toggler-node"></span>
        <span class="toggler-node"></span>
        <span class="toggler-node"></span>
      </span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a href="{% url 'index' %}" class="nav-item nav-link">{% trans "Home" %}</a></li>
        <li class="nav-item"><a href="{% url 'about' %}" class="nav-item nav-link">{% trans "About" %}</a></li>
        <li class="nav-item"><a href="{% url 'services' %}" class="nav-item nav-link">{% trans "Services" %}</a></li>
        <li class="nav-item"><a href="{% url 'past_solutions' %}" class="nav-item nav-link">{% trans "Past Solutions" %}</a></li>
        {% if user.is_authenticated %}
          <li class="nav-item"><a href="#" class="nav-item nav-link">{% trans "Hello" %}, {{ user.username }}</a></li>
          <li class="nav-item"><a href="{% url 'logout' %}" class="nav-item nav-link">{% trans "Logout" %}</a></li>
        {% else %}
          <li class="nav-item"><a href="{% url 'register' %}" class="nav-item nav-link">{% trans "Register" %}</a></li>
          <li class="nav-item"><a href="{% url 'login' %}" class="nav-item nav-link">{% trans "Login" %}</a></li>
        {% endif %}
        {% if user.is_authenticated and user.is_superuser %}
          <li class="nav-item"><a href="{% url 'admin_portal' %}" class="nav-item nav-link">{% trans "Admin" %}</a></li>
        {% endif %}
      </ul>
      <div class="navbar-buttons ms-3 d-flex">
        <button id="voice-search" class="btn btn-wens" data-gtag-event="voice_search_click">
          <i class="fas fa-microphone"></i> {% trans "Voice AI" %}
        </button>
        <button id="toggle-web" class="btn btn-wens ms-2" data-gtag-event="toggle_3d_click">
          <i class="fas fa-atom"></i> {% trans "Toggle 3D" %}
        </button>
      </div>
    </div>
  </div>
</nav>

  <!-- Content Block -->
  {% block content %}
  {% endblock %}

  <!-- Footer -->
  <footer class="footer py-4 text-center">
    <div class="container">
      <div class="row">
        <div class="col-md-3">
          <h5>{% trans "About StudySmart" %}</h5>
          <p>{% trans "Leading the way in AI, data analytics, and innovative solutions for a smarter future." %}</p>
        </div>
        <div class="col-md-3">
          <h5>{% trans "Quick Links" %}</h5>
          <a href="{% url 'index' %}">{% trans "Home" %}</a><br>
          <a href="{% url 'about' %}">{% trans "About" %}</a><br>
          <a href="{% url 'services' %}">{% trans "Services" %}</a><br>
          <a href="{% url 'register' %}">{% trans "Register" %}</a><br>
          <a href="{% url 'login' %}">{% trans "Login" %}</a>
        </div>
        <div class="col-md-3">
          <h5>{% trans "Contact Us" %}</h5>
          <a href="mailto:info@studysmartexperts.com">info@studysmartexperts.com</a><br>
          <a href="tel:+18438437046">+1 (843) 843-7046</a>
        </div>
        <div class="col-md-3">
          <h5>{% trans "Language" %}</h5>
          <form action="{% url 'set_language' %}" method="post">
            {% csrf_token %}
            <select name="language" class="form-select" onchange="this.form.submit()">
              {% for lang in LANGUAGES %}
                <option value="{{ lang.0 }}" {% if lang.0 == LANGUAGE_CODE %}selected{% endif %}>
                  {{ lang.1 }}
                </option>
              {% endfor %}
            </select>
          </form>
          <h5 class="mt-3">{% trans "Follow Us" %}</h5>
          <div class="hightech-link d-flex">
            <a href="https://x.com/wenslause5" class="btn btn-outline-light me-2"><i class="fab fa-x"></i></a>
            <a href="#" class="btn btn-outline-light me-2"><i class="fab fa-linkedin-in"></i></a>
            <a href="#" class="btn btn-outline-light"><i class="fab fa-instagram"></i></a>
          </div>
        </div>
      </div>
      <hr>
      <p>Â© 2025 <strong>{% trans "StudySmart" %}</strong>. {% trans "All rights reserved." %}</p>
      <p class="text-muted">{% trans "Transforming businesses with AI and data." %}</p>
    </div>
  </footer>

  <!-- Scripts -->
  <script defer src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js" crossorigin="anonymous"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js" crossorigin="anonymous"></script>
  <script defer src="{% static 'js/main.js' %}"></script>

  <!-- Inline GSAP Load Check -->
  <script defer>
    document.addEventListener('DOMContentLoaded', () => {
      if (typeof gsap === 'undefined') {
        console.error('GSAP failed to load. Check CDN availability or script paths.');
      } else {
        console.log('GSAP 3.12.5 loaded successfully.');
      }
    });
  </script>

  <!-- Cookie Consent Script -->
  <script defer>
    document.addEventListener('DOMContentLoaded', () => {
      const isEurope = ['EU', 'DE', 'FR', 'ES', 'IT'].includes(new Intl.DateTimeFormat().resolvedOptions().timeZone.split('/')[1]);
      if (isEurope) {
        const cookieConsent = document.getElementById('cookie-consent');
        cookieConsent.classList.remove('d-none');
        document.getElementById('accept-cookies').addEventListener('click', () => {
          cookieConsent.style.display = 'none';
          localStorage.setItem('cookies_accepted', 'true');
          gtag('consent', 'update', { 'analytics_storage': 'granted' });
        });
        document.getElementById('decline-cookies').addEventListener('click', () => {
          cookieConsent.style.display = 'none';
          localStorage.setItem('cookies_accepted', 'false');
          gtag('consent', 'update', { 'analytics_storage': 'denied' });
        });
      }
    });
  </script>

  <!-- Event Tracking for GA4 -->
  <script defer>
    document.addEventListener('DOMContentLoaded', () => {
      ['voice-search', 'toggle-web'].forEach(id => {
        const btn = document.getElementById(id);
        if (btn) {
          btn.addEventListener('click', () => {
            gtag('event', btn.dataset.gtagEvent, {
              'event_category': 'interaction',
              'event_label': id
            });
          });
        }
      });
    });
  </script>
</body>
</html>